from Crypto.Cipher import AES
import base64
import json
import urllib.parse

KEY = "S6vIY+WKhazNOvFoiNIK2hHozqCAjvD62t0Y59yO4ek="
COOKIE = "eyJpdiI6IlZ5bjNvRngybUlocURMdGU5SVBGM0E9PSIsInZhbHVlIjoiS3YrbE1pWlI1NEUzaTExMVhuRXlrUmM5N0pWeWh4azEzOHF4a0c0VUN0VFhKZkxYZHd4clRzSTFYWHhlcUUzREtXOGE1UGZDVk03VkRYWFk1NFFiTlNUMjFQcWFLOHRPb1hcL3hrdEhxa3pSXC9vRzI2OWdxWkFEUXNSSFUxUCs0b1FIaTdXSllDYm12ZlV5VXJlTW1pdUM3S0VkY2NjdHpxWENJUXN0RVg2Mmt2VmNCSUdNYjEzTFJlNHNSamhCbUhyaEhYc2dPUWxVVzB4VFwvQ3lZK3d3SWRxbUczZ0JKWFVnOXRjYmxjdTR2RXV2cFwvSzRNUDR2THVvS0RaXC9IUnZ0Sm83clZIdXBvelUwVVJnKzNJa0RibTVucnlEUkhDanVhOXJobnpLUHdPS3drNGg0YWlyanF0M3U4ZndJeTF6T0Nubk9qazNEYU4xaFg3Y1ZvZWZ2K2lLYzBjSXliTkM2Y0ZEXC9QRks2bjRqRUFFWGM3YjZxcGxWUDNiNFJMRmFwUEpTM052RlMyYVFXXC9NRWwzeTR1XC85cXNSZ2hiWnlFaE9cLzBVOVN6WnZXdFlkbEphWnlXMWN2MjA1Ukw1S3F1aU4yc21zMVpGUm93dU9SdFwvMFBvTGdRPT0iLCJtYWMiOiI0ODcyMDRhZjRkMDhjYjQwODQ5MGIxZTMzOTk3ODI3MDc3MWY3ZjQ5OWUzNmQ5NmVmOGE5OGQ1YzZkY2JhNjFkIn0%3D"


class Laravel:
    def __init__(cls, key):
        cls.key = base64.b64decode(key)

    def decrypt_value(cls, text):
        decoded_text = json.loads(base64.b64decode(
            urllib.parse.unquote_plus(text)))
        iv = base64.b64decode(decoded_text['iv'])

        crypt_object = AES.new(key=cls.key, mode=AES.MODE_CBC, IV=iv)

        decoded = base64.b64decode(decoded_text['value'])
        decrypted = crypt_object.decrypt(decoded)
        decoded_text['value'] = decrypted
        return decoded_text

    def encrypt_value(cls, decstr, encstr):
        decoded_text = json.loads(base64.b64decode(
            urllib.parse.unquote_plus(encstr)))
        iv = base64.b64decode(decoded_text['iv'])

        crypt_object = AES.new(key=cls.key, mode=AES.MODE_CBC, IV=iv)

        encoded = decstr
        encrypted = crypt_object.encrypt(encoded)
        decoded_text['value'] = base64.b64encode(encrypted)
        return decoded_text
        


lar = Laravel(KEY)
print(lar.decrypt_value(COOKIE))